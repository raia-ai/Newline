---
title: "Sagedoc"
source: "SAGEDOC.doc"
tags: [Customer Documentation]
version: "1.0"
last_updated: "2025-11-17"
short_description: "THE INTERFACE BETWEEN THE NEWLINE AND SAGE SYSTEMS THE FOLLOWING FILES ARE CREATED IN THE MARKET SYSTEM: MARKNOM1.wno ENDMAR03 CHEQUE SHEET S..."
long_description: "THE INTERFACE BETWEEN THE NEWLINE AND SAGE SYSTEMS"
---


                    THE INTERFACE BETWEEN THE NEWLINE AND SAGE
SYSTEMS

THE FOLLOWING FILES ARE CREATED IN THE MARKET SYSTEM:

  MARKNOM1.wno  ENDMAR03  CHEQUE SHEET SUMMARY

  MARKNOM2.wno  ENDMAR18  POSTING  DEBTS etc TO LEDGER

  \DEBTDIR\MARKNOM3   PTRANPAY  POSTING PAYMENTS TO LEDGER

  \DEBTDIR\MARKNOM4   PTRANINP POSTING DEBTS / CREDITS TO
LEDGER

  \DEBTDIR\MARKNOM5   PURACC  S/L STATEMENT INTEREST IF POSTED
TO LEDGER


THESE  FILES WERE ONLY  CREATED IF THE FILE MARKNOMS WAS
PRESENT IN THE WORKING MARKET DIRECTORY , BUT  IT  HAS TO BE
THERE  NOW  BECAUSE  MARKNOM1.wno IS USED IN  ENDMAR11 / 12 /
13 , WHEREAS IT WAS OPTIONAL BEFORE THE END OF MARKET ROUTINE
WAS INTRODUCED.

THE ABOVE FILES ARE USED  IN TWO POSSIBLE WAYS TO CREATE THE
SAGE FILE FOR IMPORT . THIS DEPENDS ON WHETHER A MARKET HAS
THE LATEST ENDMAR19 AND PTRANPAY


THE FIRST IS IF THEY HAVE THE OLD VERSIONS THEN  THEY USE THE
PROGRAM MAKENOMF,  WHICH IS CALLED FROM  THE OPTION - CREATE
NOMINAL FILE  IN  ASALE.   MAKENOMF CREATES A FILE
SAGEDIR$\TRANSnnn,CSV  WHERE  SAGEDIR$ IS THE CONTENT OF
C:SAGEDIR AND nnn  IS FROM THE COUNT  -\SAGEDIR$\SAGENOM.CNT.
WHEN THIS OPTION IS RUN IT ASKS FOR A WEEK NUMBER TO POST,
WHICH ALLOWS YOU TO ENTER NONE, ONE OR SEVERAL WEEKS.  IT THEN
 LOOKS TO SEE IF \DEBTDIR\MARKNOM3 /  4 / 5.CNT, ARE GREATER
THAN 1  IN WHICH CASE THESE ARE ADDED TO THE SAGE FILE AFTER
ANY SELECTED WEEK NUMBER FILES .


THE SECOND WAY USES THE NEW ENDMAR19, WHICH AUTOMATICALLY
CREATES   THE SAGE FILE USING  ENDMARK1.wno AND ENDMARK2.wno.

 THE NEW PTRANPAY CREATES \DEBTDIR\MARKNOM3.yy  AND A FILE
SAGEDIR$\TRANSnnn.CSV  AS BEFORE ,  BUT INSTEAD OF A JOURNAL
DEBIT AND CREDIT WITH A VALUE OF THE BATCH TOTAL IT WRITE THE
TWO RECORDS FOR EACH PAYMENT VALUE  AND  THE REFERENCE FIELD
INCLUDES THE PAYMENT REFERENCE AND PURCHASER NUMBER  AS WELL
AS THE BATCH NUMBER

THEY WOULD STILL NEED TO RUN MAKENOMF TO CREATE THE SAGE FILE
FOR \DEBTDIR\ENDMARK4 AND 5 UNTIL PTRANINP AND PURACC ARE
CHANGED






MARKNOMS  LENGTH  60 : CONTAINS  3 RECORDS  001-020 / 021-040
/ 041-060.

SOME MARKETS HAVE SPLIT-COM AT THE END OF THE THIRD RECORD
WHICH      SPLITS THE COMMISSION BY ANIMAL SECTION. IT ADDS
THE SECTION NUMBER TO  THE COMMISSION NOMINAL IN RECORD 3 OF
SAGENOMS. THIS IS NOW DONE IN ENDMAR19 BY HAVING THE 12
NOMINAL CODES IN RECORD 3 OF SAGENOMS

THE CODES ARE USED WHEN MARKNOM1 – 5 ARE CREATED AND ARE
WRITTEN TO   49,3 OR 52,3  DEPENDING ON WHETHER A DEBIT OR
CREDIT POSTING. THEY WERE USED ORIGINALLY TO HOLD THE NOMINAL
CODES IN OUR ACCOUNTING SYSTEM AND SO      1 – 15 ARE NOT USED
IN MAKENOMF  OR ENDMAR19 BECAUSE  THE DESCRIPTION IN THE
REFERENCE FIELD IN MARKNOM1 AND MARKNOM2  IS USED TO SELECT
THE  NOMINAL CODE  TO USE FROM THE SAGENOMS FILE . CODES 016 –
020 ARE USED FOR EXTRA DEDUCTIONS  1 – 5  AND 021 +  FOR
OTHER DEDUCTIONS 1 +

MARKNOM 1 – 5    LENGTH 70

1 – 6      DATE  DDMMYY
7 – 7      TYPE   J(ournal)
8 – 8      LEDGER M(arket)
9  – 38   REFERENCE
39 – 48  VALUE  nnnnnnn.nn
49 – 51  DEBIT -   NOMINAL CODE FROM MARKNOMS
52 – 54  CREDIT - NOMINAL CODE FROM MARKNOMS
55 – 70  NOT USED

SAGENOMS   SEQUENTIAL FILE CONTAINS THE SAGE NOMINAL CODES

RECORD 1   TOLLS
        2. VENDOR CHEQUES - USUALLY THE SAME AS THE BANK
           REC.12 BUT WILL BE ANOTHER IF THEY POST EACH
           VENDORS CHEQUE TO SAGE, ELSE THE BANK WOULD DOUBLE
           UP BY THE TOTAL CHEQUE VALUE
        3. COMMISSION
        4. VENDOR VAT  (PURCHASER VAT +1 IN MAKENOMF /
           ENDMAR19)
        5. MLC LEVY
        6. TOLL2
        7. LUCK
        8. MIC
        9. CASH PAID TO VENDOR
       10. DEBTOR CONTROL
       11. LISTR  (NOT USED)
       12. BANK ACCOUNT
       13. DISCOUNT ALLOWED IN PAYMENTS RECEIVED
       14. MANUAL INPUT  IN PTRANINP OR ADJUSTMENT IN PTRANPAY
       15. INTEREST CHARGED AND POSTED IN S/L STATEMENT
       16. – 20 EXTRA DEDUCTIONS  1 - 5
        21 +  OTHER DEDUCTIONS 1 +



SAGE  CSV SEQUENTIAL FILES  FOR IMPORTING

FIELD   1   LEN 2   TYPE  JD / JC – JOURNAL DEBIT / CREDIT.
                                                    BP - BANK
PAYMENT
                                                    SI  -
SALES INVOICES
                                                    SC – SALES
CREDITS

       2. LEN 8  ACCOUNT REFERENCE – CREDIT NOMINAL(BANK)  IN
          TYPE BP

                 OTHERWISE NOT USED


       3. LEN 8  SAGE NOMINAL CODE  -  CODE FROM  SAGENOMS


       4    LEN 3   DEPARTMENT NUMBER – 104,4  IN MARKNAME IF
       PRESENT

                    001 IN TYPE BP


       5    LEN 8   DATE  -  DDMMYYYY


       6    LEN 8   REFERENCE  - “MARKET”  :  CHEQUE NUMBER
       IN TYPE  BP


       7. LEN 30 DETAILS  -  WK.nna-VN/VEN/VEND-“DEDUCTION”
          (MARKNOM1)
                                                 WK.nna-
       PUR/PURCH-“DEDUCT/ADD”   (MARKNOM2)

       CHEQUES/CASH/DISC/ADJ-BATCH-nnn –

       PAYMENT COMMENTS / REF           (MARKNOM3)
                                INPUT-BATCH-nnn
                            (MARKNOM4)
                                                 INTEREST-
       BATCH-nnn                              (MARKNOM5)
                                                 MARKET-
       wno/VENDOR-annnn  TYPE BP (ENDMAR19)
                                                 CHEQUES-wno
         OLD WAY  TYPE BP    (SAGECHEQ)


       8    LEN  11  NET AMOUNT    NNNNNNNN.NN


       9    LEN    3  TAX CODE           T0 - ZERO RATE,  T1 –
       STANDARD,  T9 – NON VAT


                                  10  LEN   11  VAT  AMOUNT
NOT USED



                        PROGRAMS RELATED TO SAGE

                    1.  ENDMAR03  PRINTS THE CHEQUE SHEET
SUMMARY AND CREATES MARKNOM1.wno

                        IT WRITES ONE RECORD FOR EACH SUMMARY
TOTAL  ie. THE VENDORS  GROSS , EACH DEDUCTION, VAT AND TOTAL-
CHEQUES.

                         IN THE CREDIT FIELD 52,3  IT  USES
CODES 001 – 010  FOR THE  GROSS ,  VAT AND STANDARD DEDUCTIONS
AND CODES 016 – 020  FOR  ANY EXTRA DEDUCTIONS AND
021 +  FOR OTHER DEDUCTIONS.
                        IN THE DEBIT FIELD 48,3 IT USES CODE
004 FOR  VAT ON GOODS  AND 016 – 020 FOR ANY EXTRA DEDUCTION
OR 21+ FOR OTHER DEDUCTION,  WHICH SHOW AS AN ADDITION INSTEAD
OF A DEDUCTION  ON THE CHEQUE.



                        THE DESCRIPTIONS IN THE REFERENCE
FIELD AND NOT CODES 1 – 15 ARE  USED IN THE CREATION OF  THE
SAGE NOMINAL FILE  CODES. CODES 16+  ARE THE RECORD NUMBERS IN
SAGENOMS, WHICH CONTAIN THE SAGE NOMINAL CODE .

                   2.   ENDMAR18  POSTS  DEBTS, PAYMENTS,
CONTRAS AND OLD PAYMENTS  TO SALES LEDGER AND CREATES
MARKNOM2.wno

                        IT WRITES ONE RECORD FOR EACH SUMMARY
TOTAL  ie. PAYMENTS, OLD PAID, UNPAID INVOICES AND EACH
DEDUCTION

                        IN THE DEBIT FIELD 49,3 IT USES CODES
004 – 012  FOR THE  UNPAID INVOICES, PAYMENTS, OLD DEBTS PAID,
 VAT AND STANDARD DEDUCTIONS AND CODES 016 – 020 FOR ANY EXTRA
DEDUCTIONS AND 021 +  FOR OTHER DEDUCTIONS.
                        IN THE CREDIT FIELD 52,3 IT USES CODE
004 FOR  VAT ON GOODS  AND 016 – 020 FOR ANY EXTRA DEDUCTION
OR 21+ FOR OTHER DEDUCTION,  WHICH SHOW AS AN ADDITION INSTEAD
OF A DEDUCTION  ON THE INVOICE.

                        THE DESCRIPTIONS IN THE REFERENCE
FIELD AND NOT CODES 1 – 15 ARE  USED IN THE CREATION OF  THE
SAGE NOMINAL FILE  CODES. CODES 16+  ARE THE RECORD NUMBERS IN
SAGENOMS, WHICH CONTAIN THE SAGE NOMINAL CODE .

                    3. MAKENOMF CONVERTS THE FILES MARKNOM1 –
5  INTO A  CSV FILE FOR IMPORTING TO SAGE

                        IF  THEY DON’T HAVE ENDMAR19  THEN
THEY USE THE  PROGRAM MAKENOMF,  WHICH  IS CALLED FROM  THE
OPTION - CREATE NOMINAL FILE  IN  ASALE

                        MAKENOMF CREATES A FILE
SAGEDIR$\TRANSnnn,CSV  WHERE  SAGEDIR$ IS THE CONTENT OF
C:SAGEDIR AND nnn  IS FROM   \SAGEDIR$\SAGENOM.CNT.

                        WHEN THIS OPTION IS RUN IT ASKS FOR A
WEEK NUMBER TO POST, WHICH ALLOWS YOU TO ENTER NONE, ONE OR
SEVERAL WEEKS.  IT THEN  LOOKS TO SEE IF \DEBTDIR\MARKNOM3 /
4 / 5.CNT, ARE GREATER THAN 1  IN WHICH CASE THESE ARE ADDED
TO THE SAGE FILE AFTER ANY SELECTED WEEK NUMBER FILES .

                        MARKNOM1 CREATES TRANSACTIONS TYPE JC
OR  FOR VAT ON GOOD JD, AND USES THE APPROPRIATE CODE IN
SAGENOMS DEPENDING ON THE DESCRIPTION IN  9 – 38.
                        IF CODES 16+ ARE PRESENT IN   49,3
THEN  IT WILL BE TYPE JD  ELSE  JC  IF IN  52,3.
                        CODES 16+ ARE THE RECORD NUMBERS IN
SAGENOMS, WHICH CONTAIN THE SAGE NOMINAL

                        MARKNOM2 CREATES TRANSACTIONS TYPE JD
OR  FOR VAT ON GOOD JC, AND USES THE APPROPRIATE CODE IN
SAGENOMS DEPENDING ON THE DESCRIPTION IN  9 – 38.
                        IF CODES 16+ ARE PRESENT IN   49,3
THEN  IT WILL BE TYPE JD  ELSE  JC  IF IN  52,3.
                        CODES 16+ ARE THE RECORD NUMBERS IN
SAGENOMS, WHICH CONTAIN THE SAGE NOMINAL




                        MARKNOM3 CREATES A TRANSACTION TYPE
JC  IF  52,3 = 003 (NORMAL PAYMENT) AND  JD IF  49,3 =003
(NEGATIVE PAYMENT).
                        THE SAGE NOMINAL CODE  IS RECORD 10
(DEBTORS CONTROL)  IN SAGENOMS.

                        THIS RECORD IS DUPLICATED  EXCEPT THAT
THE TYPE IS OPPOSITE AND THE SAGE NOMINAL IS RECORD 12 (BANK)
FOR CHEQUES AND CASH,  RECORD 13 FOR DISCOUNT AND RECORD 14
FOR ADJUSTMENT .

                        MARKNOM4 CREATES A TRANSACTION TYPE
JD  IF  49,3 = 003 IF A DEBT  AND  JD IF  52,3 =003  IF A
CREDIT..
                        THE SAGE NOMINAL CODE  IS RECORD 10
(DEBTORS CONTROL)  IN SAGENOMS.

                        THIS RECORD IS DUPLICATED  EXCEPT THE
TYPE IS OPPOSITE AND THE SAGE NOMINAL   IS RECORD 14 .

                        MARKNOM5 CREATES A TRANSACTION TYPE
JD  ..
                        THE SAGE NOMINAL CODE  IS RECORD 10
(DEBTORS CONTROL)  IN SAGENOMS.

                        THIS RECORD IS DUPLICATED  EXCEPT THE
TYPE IS OPPOSITE AND THE SAGE NOMINAL   IS RECORD 15

                   4.  ENDMAR19  IS THE AUTOMATIC VERSION OF
MAKENOMF SO IT CONVERTS MARKNOM1 AND MARKNOM2 TO CREATE
\SAGEDIR\TRANSnnn.CSV , WHICH IS THE SAME AS MAKENOMF  EXCEPT
THAT THEY WILL ONLY CONTAIN THE CURRENT MARKET TOTALS.

                        IF THERE IS AN  “S” IN  102,1  IN
MARKNAME  FOR THAT MARKET THEN IT WILL ALSO CREATE A FILE
\SAGEDIR\CHQwno.CSV , WHICH REPLACES THE PROGRAM SAGECHEQ
CALLED FROM RECON. THIS WILL WRITE ONE  BP TRANSACTION FOR
EACH VENDOR CHEQUE IN THE OUTSTAND FILE .  FIELD 2 IS THE
CREDIT NOMINAL RECORD 12 IN SAGENOMS  AND FIELD3 IS THE DEBIT
NOMINAL RECORD 2 IN SAGENOMS.    .

SAGECHEQ  WHICH IS THE OPTION TRANSFER CHEQUES TO SAGE FILE IN
RECON.          THIS CREATES A FILE   \SAGEDIR\CHEQUES.CSV
WHICH CONTAINS ONE   BP TRANSACTION TYPE FOR EACH VENDOR
CHEQUE IN THE OUTSTAND FILE .  FIELD 2 IS  THE CREDIT NOMINAL
RECORD 12 IN SAGENOMS  AND FIELD3 IS THE DEBIT NOMINAL RECORD
2 IN SAGENOMS.

THE OLD PTRANPAY WRITES TO \DEBTDIR\MARKNOM3  STARTING FROM
THE RECORD NUMBER IN  \DEBTDIR\MARKNOM3.CNT.  THE RECORD
CONTAINS THE UNSIGNED VALUE OF THE BATCH TOTAL,   AND 52,3 =
003 (POSITIVE TOTAL)  OR  49,3 =003  (NEGATIVE TOTAL).  IT
GETS THE BATCH NUMBER FROM  \DEBTDIR\PAYMENT.CNT OR
\DEBTDIR\PAYMENT.mno IF THE 11th RECORD (MARKET NUMBER)
PRESENT IN C:\DEBTDIR

THE NEW PTRANPAY CREATES \DEBTDIR\MARKNOM3.yy  (NO COUNT) AND
A FILE  SAGEDIR$\TRANSnnn.CSV  ,  BUT INSTEAD OF A JOURNAL
DEBIT AND CREDIT WITH A VALUE OF THE BATCH TOTAL,  IT WRITES
THE TWO RECORDS FOR EACH PAYMENT VALUE  AND  THE REFERENCE
FIELD INCLUDES THE PAYMENT REFERENCE AND PURCHASER NUMBER  AS
WELL AS THE BATCH NUMBER. THE TRANSACTION TYPE  WILL BE JC  IF
 52,3 = 003 (NORMAL PAYMENT) AND  JD IF  49,3 =003  (NEGATIVE
PAYMENT).
                        THE SAGE NOMINAL CODE  IS RECORD 10
(DEBTORS CONTROL)  IN SAGENOMS.


PTRANINP WRITES TO \DEBTDIR\MARKNOM4  STARTING FROM THE RECORD
NUMBER IN  \DEBTDIR\MARKNOM4.CNT.  THE RECORD CONTAINS THE
UNSIGNED VALUE OF THE BATCH TOTAL,   AND 49,3 = 003 (POSITIVE
TOTAL)  OR  52,3 =003  (NEGATIVE TOTAL).  IT GETS THE BATCH
NUMBER FROM  \DEBTDIR\PURCHASE.CNT

PURACC WRITES TO \DEBTDIR\MARKNOM5  STARTING FROM THE RECORD
NUMBER IN  \DEBTDIR\MARKNOM5.CNT.  THE RECORD CONTAINS THE
UNSIGNED VALUE OF THE BATCH TOTAL,   AND 49,3 = 003 .  IT GETS
THE BATCH NUMBER FROM  \DEBTDIR\INTEREST.CNT

SAGE2OUT  READS A SELECTED FILE IN  \SAGEDIR  LOOKING FOR
TRANSACTION TYPE PP AND ADDS A CHEQUE RECORD IN
\DEBTDIR\OUTSTAND.BIG FOR EVERY ONE IT FINDS. IT ADDS TO THE
FILE STARTING FROM \DEBTDIR\OUTSTAND.BNT FOR EVERY ONE  IT
FINDS

SAGE2MAR  READS A SELECTED FILE IN  \SAGEDIR  LOOKING FOR
TRANSACTION TYPES  SI AND SC AND ADDS A PURCHASE TRANSACTION
RECORD FOR EACH ONE IN \DEBTDIR\T?. USING \DEBTDIR\COUNTS1.CNT
.  THE VALUE IS MULTIPLIED BY  -1   IF TRANSACTION TYPE IS SC

SAGE2NL  IS A VB VERSION OF SAGE2MAR


ALL THE PROGRAMS CREATING A FILE FOR SAGE PRINT A REPORT AND
THE NAME OF THE FILE FOR IMPORTING INTO SAGE

TO IMPORT A FILE INTO SAGE THEY NEED TO BE ON THEIR MAIN MENU
AND CHOOSE  FILE, IMPORT,  AUDIT TRAIL TRANSACTIONS  AND THEN
RUN.


